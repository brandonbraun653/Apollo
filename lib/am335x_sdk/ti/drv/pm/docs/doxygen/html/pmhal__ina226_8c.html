<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>pmhal_ina226.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<table width=100%>
<tr>
  <td bgcolor="black" width="1"><a href="http://www.ti.com"><img border=0 src="../../tilogo.gif"></a></td>
  <td bgcolor="red"><img src="../../titagline.gif"></td>
</tr>
</table>
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_24c84a99586fed3db8b2257cf02e9a6c.html">pmhal</a></li><li class="navelem"><a class="el" href="dir_3fa2f83f4593ba409444d8ad12d4153e.html">prcm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">pmhal_ina226.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains the API to program and read the INA226 power measurement ICs. In order to read the INA's on board from the target please ensure necessary board modifications have been done to read the INA registers via I2C.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &quot;<a class="el" href="pm__types_8h.html">pm_types.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pm__utils_8h.html">pm_utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pmhal__i2c_comm_8h.html">pmhal_i2cComm.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pmhal__ina226_8h.html">pmhal_ina226.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hw__pmhal__common__ina226data_8h.html">hw_pmhal_common_ina226data.h</a>&quot;</code><br />
<code>#include &lt;ti/csl/hw_types.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a517c31f162ae6d5915704e336120a145"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="pm__types_8h.html#aaa0d1ee0f22b2df6888809fd8e77ea9b">pmErrCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pmhal__ina226_8c.html#a517c31f162ae6d5915704e336120a145">PmhalIna226CommConfigure</a> (uint8_t i2cNum)</td></tr>
<tr class="memdesc:a517c31f162ae6d5915704e336120a145"><td class="mdescLeft">&#160;</td><td class="mdescRight">This API calls the I2C initialization function. If the initialization is complete the API exits with a pass with out calling the initialization multiple times.  <a href="#a517c31f162ae6d5915704e336120a145">More...</a><br /></td></tr>
<tr class="separator:a517c31f162ae6d5915704e336120a145"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a979b8b4a464fe7049cb6aa0ac4a45b3e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="pm__types_8h.html#aaa0d1ee0f22b2df6888809fd8e77ea9b">pmErrCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pmhal__ina226_8c.html#a979b8b4a464fe7049cb6aa0ac4a45b3e">PmhalIna226Read16</a> (uint8_t i2cNum, uint8_t slaveAddr, uint8_t regAddr, uint16_t *value)</td></tr>
<tr class="memdesc:a979b8b4a464fe7049cb6aa0ac4a45b3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This API calls the I2C read function to read the value of the 16 bit register at the given register base address.  <a href="#a979b8b4a464fe7049cb6aa0ac4a45b3e">More...</a><br /></td></tr>
<tr class="separator:a979b8b4a464fe7049cb6aa0ac4a45b3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa74ea7e6f75dfb911959eeab8d16a9b1"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="pm__types_8h.html#aaa0d1ee0f22b2df6888809fd8e77ea9b">pmErrCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pmhal__ina226_8c.html#aa74ea7e6f75dfb911959eeab8d16a9b1">PmhalIna226Write16</a> (uint8_t i2cNum, uint8_t slaveAddr, uint8_t regAddr, uint16_t value)</td></tr>
<tr class="memdesc:aa74ea7e6f75dfb911959eeab8d16a9b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This API calls the I2C write function to write a 16 bit value to an INA register at the given register base address.  <a href="#aa74ea7e6f75dfb911959eeab8d16a9b1">More...</a><br /></td></tr>
<tr class="separator:aa74ea7e6f75dfb911959eeab8d16a9b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga09ac86ee4a7e23a19649c09010d39609"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pm__types_8h.html#aaa0d1ee0f22b2df6888809fd8e77ea9b">pmErrCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_r_c_m___s_t_a_t.html#ga09ac86ee4a7e23a19649c09010d39609">PMHALINA226SetBusVoltConversionTime</a> (<a class="el" href="group___m_i_s_c.html#gaad27b65507a152c937ab53f2dcc277b8">pmhalPrcmPmicRegulatorId_t</a> voltDomId, <a class="el" href="group___p_r_c_m___s_t_a_t.html#gae55eeaa6af1fbdbf61ad2448b510b7af">pmhalIna226ConvTime_t</a> convTime)</td></tr>
<tr class="memdesc:ga09ac86ee4a7e23a19649c09010d39609"><td class="mdescLeft">&#160;</td><td class="mdescRight">Program the INA226 Bus Voltage measurement conversion time.  <a href="group___p_r_c_m___s_t_a_t.html#ga09ac86ee4a7e23a19649c09010d39609">More...</a><br /></td></tr>
<tr class="separator:ga09ac86ee4a7e23a19649c09010d39609"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaacc3ab88ba1cacca5c10252806a784a7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pm__types_8h.html#aaa0d1ee0f22b2df6888809fd8e77ea9b">pmErrCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_r_c_m___s_t_a_t.html#gaacc3ab88ba1cacca5c10252806a784a7">PMHALINA226SetShuntVoltConversionTime</a> (<a class="el" href="group___m_i_s_c.html#gaad27b65507a152c937ab53f2dcc277b8">pmhalPrcmPmicRegulatorId_t</a> voltDomId, <a class="el" href="group___p_r_c_m___s_t_a_t.html#gae55eeaa6af1fbdbf61ad2448b510b7af">pmhalIna226ConvTime_t</a> convTime)</td></tr>
<tr class="memdesc:gaacc3ab88ba1cacca5c10252806a784a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Program the INA226 Shunt Voltage measurement conversion time.  <a href="group___p_r_c_m___s_t_a_t.html#gaacc3ab88ba1cacca5c10252806a784a7">More...</a><br /></td></tr>
<tr class="separator:gaacc3ab88ba1cacca5c10252806a784a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga078627caf899b3ac43eeaf0b665b31c9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pm__types_8h.html#aaa0d1ee0f22b2df6888809fd8e77ea9b">pmErrCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_r_c_m___s_t_a_t.html#ga078627caf899b3ac43eeaf0b665b31c9">PMHALINA226SetAverage</a> (<a class="el" href="group___m_i_s_c.html#gaad27b65507a152c937ab53f2dcc277b8">pmhalPrcmPmicRegulatorId_t</a> voltDomId, <a class="el" href="group___p_r_c_m___s_t_a_t.html#ga381697f87eb3ae78bfcda4fb1e755af9">pmhalIna226NumAverages_t</a> average)</td></tr>
<tr class="memdesc:ga078627caf899b3ac43eeaf0b665b31c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Program the INA226 ADC average number of samples.  <a href="group___p_r_c_m___s_t_a_t.html#ga078627caf899b3ac43eeaf0b665b31c9">More...</a><br /></td></tr>
<tr class="separator:ga078627caf899b3ac43eeaf0b665b31c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga56dc13c63d6af54df4af14b6d90919d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pm__types_8h.html#aaa0d1ee0f22b2df6888809fd8e77ea9b">pmErrCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___p_r_c_m___s_t_a_t.html#ga56dc13c63d6af54df4af14b6d90919d0">PMHALINA226GetData</a> (<a class="el" href="group___m_i_s_c.html#gaad27b65507a152c937ab53f2dcc277b8">pmhalPrcmPmicRegulatorId_t</a> voltDomId, <a class="el" href="group___p_r_c_m___s_t_a_t.html#gae2b978980c0f2b7e17eeb8f811eaee8f">pmhalIna226OutputData_t</a> *data)</td></tr>
<tr class="memdesc:ga56dc13c63d6af54df4af14b6d90919d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the INA226 registers to find the voltage and power drawn for a given voltage domain.  <a href="group___p_r_c_m___s_t_a_t.html#ga56dc13c63d6af54df4af14b6d90919d0">More...</a><br /></td></tr>
<tr class="separator:ga56dc13c63d6af54df4af14b6d90919d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains the API to program and read the INA226 power measurement ICs. In order to read the INA's on board from the target please ensure necessary board modifications have been done to read the INA registers via I2C. </p>
<p>Example: For the TDA2xx board, make the following changes to the TI EVM Change the select for RU113 multiplexer on the board by making R264 = 10k &amp; R265 = NO-POP. This allows DCAN2 Signalling. Then perform a blue wiring for the following connections:</p><ol type="1">
<li>DCAN2_TX (JP3 pin 1) to PM_I2C_SDA (J8 pin 2)</li>
<li>DCAN2_RX (JP3 pin 2) to PM_I2C_SCL (J8 pin 1) Configure the PAD configuration registers such that the gpio6_14 and gpio6_15 pads operate as I2C3_SDA and I2C3_SCL respectively. </li>
</ol>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a517c31f162ae6d5915704e336120a145"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="pm__types_8h.html#aaa0d1ee0f22b2df6888809fd8e77ea9b">pmErrCode_t</a> PmhalIna226CommConfigure </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>i2cNum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This API calls the I2C initialization function. If the initialization is complete the API exits with a pass with out calling the initialization multiple times. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i2cNum</td><td>I2C number to which the INA is connected.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Status</td><td>Status of the API call. Can be any of the following, PM_SUCCESS Indicates the operation is success PM_FAIL Indicates the API failed for desired functionality </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a979b8b4a464fe7049cb6aa0ac4a45b3e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="pm__types_8h.html#aaa0d1ee0f22b2df6888809fd8e77ea9b">pmErrCode_t</a> PmhalIna226Read16 </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>i2cNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slaveAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>regAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This API calls the I2C read function to read the value of the 16 bit register at the given register base address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i2cNum</td><td>I2C number to which the INA is connected. </td></tr>
    <tr><td class="paramname">slaveAddr</td><td>I2C address using which the INA is read. </td></tr>
    <tr><td class="paramname">regAddr</td><td>Register address to read. </td></tr>
    <tr><td class="paramname">value</td><td>Stores the 16 bit value read from the INA register.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Status</td><td>Status of the API call. Can be any of the following, PM_SUCCESS Indicates the operation is success PM_FAIL Indicates the API failed to read the register. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa74ea7e6f75dfb911959eeab8d16a9b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="pm__types_8h.html#aaa0d1ee0f22b2df6888809fd8e77ea9b">pmErrCode_t</a> PmhalIna226Write16 </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>i2cNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slaveAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>regAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This API calls the I2C write function to write a 16 bit value to an INA register at the given register base address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i2cNum</td><td>I2C number to which the INA is connected. </td></tr>
    <tr><td class="paramname">slaveAddr</td><td>I2C address using which the INA is write. </td></tr>
    <tr><td class="paramname">regAddr</td><td>Register address to write. </td></tr>
    <tr><td class="paramname">value</td><td>Stores the 16 bit value to be written to the INA.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Status</td><td>Status of the API call. Can be any of the following, PM_SUCCESS Indicates the operation is success PM_FAIL Indicates the API failed to write to the register. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<hr size="1"><small>
Copyright  2020, Texas Instruments Incorporated</small>
</body>
</html>
