<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>pm_thermal_main.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<table width=100%>
<tr>
  <td bgcolor="black" width="1"><a href="http://www.ti.com"><img border=0 src="../../tilogo.gif"></a></td>
  <td bgcolor="red"><img src="../../titagline.gif"></td>
</tr>
</table>
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d28a4824dc47e487b107a5db32ef43c4.html">examples</a></li><li class="navelem"><a class="el" href="dir_24062f79aa0ca3d7ca58b989d465bf30.html">pmrtos_thermal</a></li><li class="navelem"><a class="el" href="dir_29fe766835231ee3c962b19bd023dfd1.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">pm_thermal_main.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>pm rtos thermal management implementation example.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;xdc/std.h&gt;</code><br />
<code>#include &lt;xdc/runtime/Error.h&gt;</code><br />
<code>#include &lt;xdc/runtime/System.h&gt;</code><br />
<code>#include &lt;ti/sysbios/BIOS.h&gt;</code><br />
<code>#include &lt;ti/sysbios/knl/Task.h&gt;</code><br />
<code>#include &lt;ti/sysbios/knl/Clock.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;ti/csl/soc.h&gt;</code><br />
<code>#include &lt;ti/csl/hw_types.h&gt;</code><br />
<code>#include &lt;ti/csl/csl_timer.h&gt;</code><br />
<code>#include &lt;<a class="el" href="pmhal_8h.html">ti/drv/pm/pmhal.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="pmlib_8h.html">ti/drv/pm/pmlib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_power_8h.html">ti/drv/pm/Power.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_power_extended_8h.html">ti/drv/pm/PowerExtended.h</a>&gt;</code><br />
<code>#include &lt;ti/drv/pm/PowerDevice.h&gt;</code><br />
<code>#include &lt;<a class="el" href="pmlib__boardconfig_8h.html">ti/drv/pm/include/pmlib_boardconfig.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="pmhal__i2c_comm_8h.html">ti/drv/pm/include/prcm/pmhal_i2cComm.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="pmhal__pmic_comm_8h.html">ti/drv/pm/include/prcm/pmhal_pmicComm.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="pmhal__tps659039_8h.html">ti/drv/pm/include/pmic/pmhal_tps659039.h</a>&gt;</code><br />
<code>#include &lt;ti/csl/arch/csl_arch.h&gt;</code><br />
<code>#include &lt;ti/csl/csl_i2c.h&gt;</code><br />
<code>#include &quot;<a class="el" href="app__utils_8h.html">app_utils.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aec67ca2e50ee09eddc5fbee8468f7b81"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#aec67ca2e50ee09eddc5fbee8468f7b81">PM_TEST_UTILS_I2C_SYSTEM_CLOCK</a>&#160;&#160;&#160;(96000000U)</td></tr>
<tr class="separator:aec67ca2e50ee09eddc5fbee8468f7b81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06b47337789866e5c561b6c82324b7f1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a06b47337789866e5c561b6c82324b7f1">PM_TEST_UTILS_I2C_INTERNAL_CLOCK</a>&#160;&#160;&#160;(9600000U)</td></tr>
<tr class="separator:a06b47337789866e5c561b6c82324b7f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35f8e711629c6a0f8a8a8d768eae42bf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a35f8e711629c6a0f8a8a8d768eae42bf">PM_TEST_UTILS_I2C_OUTPUT_CLOCK</a>&#160;&#160;&#160;(400000U)</td></tr>
<tr class="separator:a35f8e711629c6a0f8a8a8d768eae42bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a471ad8fa6a0afe6fac341eb46f58b6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a0a471ad8fa6a0afe6fac341eb46f58b6">PM_TEST_UTILS_I2C_TIMEOUT_COUNT</a>&#160;&#160;&#160;(4000U)</td></tr>
<tr class="separator:a0a471ad8fa6a0afe6fac341eb46f58b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a2499a71d7603b3b4355212f7505226"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a4a2499a71d7603b3b4355212f7505226">PM_TEST_UTILS_I2C_WRITE</a>&#160;&#160;&#160;(1U)</td></tr>
<tr class="separator:a4a2499a71d7603b3b4355212f7505226"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97bf7e2e0952dedc6a76f9a4f53b8147"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a97bf7e2e0952dedc6a76f9a4f53b8147">PM_TEST_UTILS_I2C_READ</a>&#160;&#160;&#160;(2U)</td></tr>
<tr class="separator:a97bf7e2e0952dedc6a76f9a4f53b8147"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cccc43416c3f01d4ea374e1ebc597bc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a1cccc43416c3f01d4ea374e1ebc597bc">TEMP_HISTORY</a>&#160;&#160;&#160;(10U)</td></tr>
<tr class="separator:a1cccc43416c3f01d4ea374e1ebc597bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ea3dcd9b30e18a805ff947e166dbc63"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a1ea3dcd9b30e18a805ff947e166dbc63">HEAT_UP_ITERATIONS</a>&#160;&#160;&#160;(1000000)</td></tr>
<tr class="separator:a1ea3dcd9b30e18a805ff947e166dbc63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affb26b2f2f03bcb2cdc5e56d7eb06364"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#affb26b2f2f03bcb2cdc5e56d7eb06364">TEMP_STABLE_STDDEV</a>&#160;&#160;&#160;(1U)</td></tr>
<tr class="separator:affb26b2f2f03bcb2cdc5e56d7eb06364"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84d07da1ae1b624cb5c6368723a90183"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a84d07da1ae1b624cb5c6368723a90183">TEMP_HIGH_MOD</a>&#160;&#160;&#160;(4U)</td></tr>
<tr class="separator:a84d07da1ae1b624cb5c6368723a90183"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a000b00a05eccf39f3030af36e875efd0"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a000b00a05eccf39f3030af36e875efd0">PmTestUtilsI2cInit</a> (void)</td></tr>
<tr class="memdesc:a000b00a05eccf39f3030af36e875efd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs the I2C initialization to talk to PMIC.  <a href="#a000b00a05eccf39f3030af36e875efd0">More...</a><br /></td></tr>
<tr class="separator:a000b00a05eccf39f3030af36e875efd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0535273095b1ac10b8ec3c4892cfdc94"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a0535273095b1ac10b8ec3c4892cfdc94">PmTestUtilsI2cReadByte</a> (uint32_t i2cNum, uint32_t i2cDevAddr, const uint8_t *regAddr, uint8_t *regValue, uint32_t numRegs)</td></tr>
<tr class="memdesc:a0535273095b1ac10b8ec3c4892cfdc94"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function reads a byte from the PMIC via I2C.  <a href="#a0535273095b1ac10b8ec3c4892cfdc94">More...</a><br /></td></tr>
<tr class="separator:a0535273095b1ac10b8ec3c4892cfdc94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae086c5e0a1abfdc042b67854144ab9ee"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#ae086c5e0a1abfdc042b67854144ab9ee">PmTestUtilsI2cWriteByte</a> (uint32_t i2cNum, uint32_t i2cDevAddr, const uint8_t *regAddr, const uint8_t *regValue, uint32_t numRegs)</td></tr>
<tr class="memdesc:ae086c5e0a1abfdc042b67854144ab9ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function writes a byte of data to the register of PMIC via I2C.  <a href="#ae086c5e0a1abfdc042b67854144ab9ee">More...</a><br /></td></tr>
<tr class="separator:ae086c5e0a1abfdc042b67854144ab9ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4eb9be53cdcdc26ab3a2f1ac8292f37"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#af4eb9be53cdcdc26ab3a2f1ac8292f37">PmTestUtilsI2cWaitForBB</a> (uint32_t i2cNum)</td></tr>
<tr class="memdesc:af4eb9be53cdcdc26ab3a2f1ac8292f37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Poll for Bus Busy and return when bus is not busy or timed out.  <a href="#af4eb9be53cdcdc26ab3a2f1ac8292f37">More...</a><br /></td></tr>
<tr class="separator:af4eb9be53cdcdc26ab3a2f1ac8292f37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6de9d76ded189b0d5e381f5f113172c2"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a6de9d76ded189b0d5e381f5f113172c2">PmTestUtilsI2cWaitForFlags</a> (uint32_t i2cNum, uint32_t flags)</td></tr>
<tr class="memdesc:a6de9d76ded189b0d5e381f5f113172c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Poll for the given flags and return when any of the flags is set or timed out.  <a href="#a6de9d76ded189b0d5e381f5f113172c2">More...</a><br /></td></tr>
<tr class="separator:a6de9d76ded189b0d5e381f5f113172c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2312e909b6f08a1d1f04e5bd0a04bdc3"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a2312e909b6f08a1d1f04e5bd0a04bdc3">PmTestUtilsI2cWrite</a> (uint32_t i2cNum, uint8_t slaveAddr, const uint8_t data[], uint8_t count)</td></tr>
<tr class="memdesc:a2312e909b6f08a1d1f04e5bd0a04bdc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the given number of bytes to the given slave address.  <a href="#a2312e909b6f08a1d1f04e5bd0a04bdc3">More...</a><br /></td></tr>
<tr class="separator:a2312e909b6f08a1d1f04e5bd0a04bdc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8789c366ed9d6ad3f71658badd474d6e"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a8789c366ed9d6ad3f71658badd474d6e">PmTestUtilsI2cRead</a> (uint32_t i2cNum, uint8_t slaveAddr, uint8_t *value)</td></tr>
<tr class="memdesc:a8789c366ed9d6ad3f71658badd474d6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read one byte from the given slave address.  <a href="#a8789c366ed9d6ad3f71658badd474d6e">More...</a><br /></td></tr>
<tr class="separator:a8789c366ed9d6ad3f71658badd474d6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a448c3b597aeaebb233287d687d0f71f2"><td class="memItemLeft" align="right" valign="top">static int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a448c3b597aeaebb233287d687d0f71f2">PmTestUtilsI2cCheckXfrStatus</a> (uint32_t i2cNum, uint32_t xfr)</td></tr>
<tr class="memdesc:a448c3b597aeaebb233287d687d0f71f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the status of the transfer and handle the error conditions.  <a href="#a448c3b597aeaebb233287d687d0f71f2">More...</a><br /></td></tr>
<tr class="separator:a448c3b597aeaebb233287d687d0f71f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a573a429faa17ea90eb89ef67d10c418c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a573a429faa17ea90eb89ef67d10c418c"></a>
static uint32_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a573a429faa17ea90eb89ef67d10c418c">gRootClkFreqList</a></td></tr>
<tr class="memdesc:a573a429faa17ea90eb89ef67d10c418c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the root clock frequencies specific for a given platform. <br /></td></tr>
<tr class="separator:a573a429faa17ea90eb89ef67d10c418c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a4cd7ae7192850d2316802828c8ddc5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3a4cd7ae7192850d2316802828c8ddc5"></a>
static <a class="el" href="group___b_o_a_r_d___c_o_n_f_i_g.html#ga8c2d86f8301faec75a094a961926df56">pmlibBoardVdRailShare_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__thermal__main_8c.html#a3a4cd7ae7192850d2316802828c8ddc5">gVdRailShareList</a></td></tr>
<tr class="memdesc:a3a4cd7ae7192850d2316802828c8ddc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the voltage domains information whose rails are shared. <br /></td></tr>
<tr class="separator:a3a4cd7ae7192850d2316802828c8ddc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>pm rtos thermal management implementation example. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a1ea3dcd9b30e18a805ff947e166dbc63"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HEAT_UP_ITERATIONS&#160;&#160;&#160;(1000000)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Heat up loop iterations </p>

</div>
</div>
<a class="anchor" id="a06b47337789866e5c561b6c82324b7f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PM_TEST_UTILS_I2C_INTERNAL_CLOCK&#160;&#160;&#160;(9600000U)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>I2C Internal Clock - 9.6 MHz , Fast Mode of Communication is is used here. A pre-scaler of 23 would be calculated here. Refer TRM for details on the different I2C modes. </p>

</div>
</div>
<a class="anchor" id="a35f8e711629c6a0f8a8a8d768eae42bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PM_TEST_UTILS_I2C_OUTPUT_CLOCK&#160;&#160;&#160;(400000U)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>I2C Output Clock - 400 KHz, This complies with the Fast Mode of the I2C operation of 100 Kbps. </p>

</div>
</div>
<a class="anchor" id="a97bf7e2e0952dedc6a76f9a4f53b8147"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PM_TEST_UTILS_I2C_READ&#160;&#160;&#160;(2U)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read Flag used when checking for the transfer status. </p>

</div>
</div>
<a class="anchor" id="aec67ca2e50ee09eddc5fbee8468f7b81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PM_TEST_UTILS_I2C_SYSTEM_CLOCK&#160;&#160;&#160;(96000000U)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>I2C System Clock - PER_96M_CLK: 96 MHz </p>

</div>
</div>
<a class="anchor" id="a0a471ad8fa6a0afe6fac341eb46f58b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PM_TEST_UTILS_I2C_TIMEOUT_COUNT&#160;&#160;&#160;(4000U)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>When checking for I2C IRQSTATUS setting this count is used to repeatedly check the status. This number is empirically derived. </p>

</div>
</div>
<a class="anchor" id="a4a2499a71d7603b3b4355212f7505226"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PM_TEST_UTILS_I2C_WRITE&#160;&#160;&#160;(1U)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write Flag used when checking for the transfer status. </p>

</div>
</div>
<a class="anchor" id="a84d07da1ae1b624cb5c6368723a90183"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TEMP_HIGH_MOD&#160;&#160;&#160;(4U)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>High offset from stable temperature to raise to hit hot alert </p>

</div>
</div>
<a class="anchor" id="a1cccc43416c3f01d4ea374e1ebc597bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TEMP_HISTORY&#160;&#160;&#160;(10U)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Depth of temperature history buffer </p>

</div>
</div>
<a class="anchor" id="affb26b2f2f03bcb2cdc5e56d7eb06364"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TEMP_STABLE_STDDEV&#160;&#160;&#160;(1U)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Stable temperature standard deviation </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a448c3b597aeaebb233287d687d0f71f2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int32_t PmTestUtilsI2cCheckXfrStatus </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>i2cNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>xfr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check the status of the transfer and handle the error conditions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i2cNum</td><td>The I2C number used on the board to connect to the desired PMIC. </td></tr>
    <tr><td class="paramname">xfr</td><td>Transfer Type. Can be any one of PM_TEST_UTILS_I2C_WRITE or PM_TEST_UTILS_I2C_READ.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">status</td><td>Pass or fail value of the operations. STW_SOK - If Pass STW_EFAIL - If Fail </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a000b00a05eccf39f3030af36e875efd0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int32_t PmTestUtilsI2cInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function performs the I2C initialization to talk to PMIC. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">None.</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None.</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8789c366ed9d6ad3f71658badd474d6e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int32_t PmTestUtilsI2cRead </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>i2cNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slaveAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read one byte from the given slave address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i2cNum</td><td>The I2C number used on the board to connect to the desired PMIC. </td></tr>
    <tr><td class="paramname">slaveAddr</td><td>Address to which the data should be written. </td></tr>
    <tr><td class="paramname">value</td><td>Data to be read is returned.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">status</td><td>Pass or fail value of the operations. STW_SOK - If Pass STW_EFAIL - If Fail </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0535273095b1ac10b8ec3c4892cfdc94"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int32_t PmTestUtilsI2cReadByte </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>i2cNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>i2cDevAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>regAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>regValue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>numRegs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function reads a byte from the PMIC via I2C. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i2cNum</td><td>Instance Id of the I2C. 1 - for I2C1, 2 - for I2C2 </td></tr>
    <tr><td class="paramname">i2cDevAddr</td><td>I2C Slave address for the PMIC </td></tr>
    <tr><td class="paramname">regAddr</td><td>Pointer to the register address which is to be read. </td></tr>
    <tr><td class="paramname">regValue</td><td>Pointer to the location where the read value will be placed. </td></tr>
    <tr><td class="paramname">numRegs</td><td>Number of registers to be read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">status</td><td>Pass or fail value of the operations. STW_SOK - If Pass STW_EFAIL - If Fail </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af4eb9be53cdcdc26ab3a2f1ac8292f37"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int32_t PmTestUtilsI2cWaitForBB </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>i2cNum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Poll for Bus Busy and return when bus is not busy or timed out. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i2cNum</td><td>The I2C number used on the board to connect to the desired PMIC.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">status</td><td>Pass or fail value of the operations. STW_SOK - If Pass STW_EFAIL - If Fail </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6de9d76ded189b0d5e381f5f113172c2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int32_t PmTestUtilsI2cWaitForFlags </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>i2cNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Poll for the given flags and return when any of the flags is set or timed out. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i2cNum</td><td>The I2C number used on the board to connect to the desired PMIC. </td></tr>
    <tr><td class="paramname">flags</td><td>Flag to be waited for.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">status</td><td>Pass or fail value of the operations. STW_SOK - If Pass STW_EFAIL - If Fail </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2312e909b6f08a1d1f04e5bd0a04bdc3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int32_t PmTestUtilsI2cWrite </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>i2cNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slaveAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>data</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write the given number of bytes to the given slave address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i2cNum</td><td>The I2C number used on the board to connect to the desired PMIC. </td></tr>
    <tr><td class="paramname">slaveAddr</td><td>Address to which the data should be written. </td></tr>
    <tr><td class="paramname">data</td><td>Data to be written. </td></tr>
    <tr><td class="paramname">count</td><td>Number of Bytes to be written.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">status</td><td>Pass or fail value of the operations. STW_SOK - If Pass STW_EFAIL - If Fail </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae086c5e0a1abfdc042b67854144ab9ee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int32_t PmTestUtilsI2cWriteByte </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>i2cNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>i2cDevAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>regAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>regValue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>numRegs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function writes a byte of data to the register of PMIC via I2C. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i2cNum</td><td>Instance Id of the I2C. 1 - for I2C1, 2 - for I2C2 </td></tr>
    <tr><td class="paramname">i2cDevAddr</td><td>I2C Slave address for the PMIC </td></tr>
    <tr><td class="paramname">regAddr</td><td>Pointer to the register address which is to be written. </td></tr>
    <tr><td class="paramname">regValue</td><td>Pointer to the location where the write value will be placed. </td></tr>
    <tr><td class="paramname">numRegs</td><td>Number of registers to be written.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">status</td><td>Pass or fail value of the operations. STW_SOK - If Pass STW_EFAIL - If Fail </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<hr size="1"><small>
Copyright  2020, Texas Instruments Incorporated</small>
</body>
</html>
