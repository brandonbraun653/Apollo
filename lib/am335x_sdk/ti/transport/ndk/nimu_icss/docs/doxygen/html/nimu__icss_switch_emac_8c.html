<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>nimu_icssSwitchEmac.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<table width=100%>
<tr>
  <td bgcolor="black" width="1"><a href="http://www.ti.com"><img border=0 src="../../tilogo.gif"></a></td>
  <td bgcolor="red"><img src="../../titagline.gif"></td>
</tr>
</table>
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">nimu_icssSwitchEmac.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains helper functions used to implement NDK NIMU transport driver interface for ICSS.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;ti/csl/hw_types.h&gt;</code><br />
<code>#include &lt;ti/csl/csl_mdioAux.h&gt;</code><br />
<code>#include &quot;ti/transport/ndk/nimu_icss/src/nimu_icss_transport_log.h&quot;</code><br />
<code>#include &quot;<a class="el" href="nimu__icss_switch_emac_8h.html">ti/transport/ndk/nimu_icss/src/nimu_icssSwitchEmac.h</a>&quot;</code><br />
<code>#include &quot;ti/transport/ndk/nimu_icss/nimu_icssIoctl.h&quot;</code><br />
<code>#include &quot;ti/drv/icss_emac/icss_emacStatistics.h&quot;</code><br />
<code>#include &quot;ti/drv/icss_emac/icss_emacStormControl.h&quot;</code><br />
<code>#include &quot;<a class="el" href="nimu__icss_eth_8h.html">ti/transport/ndk/nimu_icss/nimu_icssEth.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a566fed1c55162e0bf1dc8e701eb8e0f1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a566fed1c55162e0bf1dc8e701eb8e0f1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nimu__icss_switch_emac_8c.html#a566fed1c55162e0bf1dc8e701eb8e0f1">NIMU_ICSS_packetInit</a> (<a class="el" href="nimu__icss_switch_emac_8h.html#a84525504342c268de0301abce94f5e8a">NIMU_IcssEmacPkt</a> *pNimuPacket)</td></tr>
<tr class="memdesc:a566fed1c55162e0bf1dc8e701eb8e0f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function initialize an NIMU_IcssEmacPkt to receive packets. <br /></td></tr>
<tr class="separator:a566fed1c55162e0bf1dc8e701eb8e0f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8d62f6c569d53a111cb9a71980feec8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa8d62f6c569d53a111cb9a71980feec8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nimu__icss_switch_emac_8c.html#aa8d62f6c569d53a111cb9a71980feec8">NIMU_ICSS_packetShutdown</a> (<a class="el" href="nimu__icss_eth_8h.html#a9ef1984a01e51df3e3d4507e989ce2c7">NIMU_IcssPdInfo</a> *pi)</td></tr>
<tr class="memdesc:aa8d62f6c569d53a111cb9a71980feec8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function free Rx packet buffer. <br /></td></tr>
<tr class="separator:aa8d62f6c569d53a111cb9a71980feec8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae805ded44f8b9fdf9bdadd18613ee0be"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae805ded44f8b9fdf9bdadd18613ee0be"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nimu__icss_switch_emac_8c.html#ae805ded44f8b9fdf9bdadd18613ee0be">NIMU_ICSS_updateStats</a> (<a class="el" href="nimu__icss_eth_8h.html#a9ef1984a01e51df3e3d4507e989ce2c7">NIMU_IcssPdInfo</a> *pd, uint8_t portNo)</td></tr>
<tr class="memdesc:ae805ded44f8b9fdf9bdadd18613ee0be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update our local copy of the statistics. <br /></td></tr>
<tr class="separator:ae805ded44f8b9fdf9bdadd18613ee0be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a844e765225701ffbdb121af92a5efdf0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nimu__icss_switch_emac_8c.html#a844e765225701ffbdb121af92a5efdf0">NIMU_ICSS_openPeripheral</a> (<a class="el" href="nimu__icss_eth_8h.html#a9ef1984a01e51df3e3d4507e989ce2c7">NIMU_IcssPdInfo</a> *pi)</td></tr>
<tr class="memdesc:a844e765225701ffbdb121af92a5efdf0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens the EMAC peripheral at the given physical index and initializes it to an embryonic state.  <a href="#a844e765225701ffbdb121af92a5efdf0">More...</a><br /></td></tr>
<tr class="separator:a844e765225701ffbdb121af92a5efdf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a866dc644841cd14596406a0216d253c3"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nimu__icss_switch_emac_8c.html#a866dc644841cd14596406a0216d253c3">NIMU_ICSS_closePeripheral</a> (<a class="el" href="nimu__icss_eth_8h.html#a9ef1984a01e51df3e3d4507e989ce2c7">NIMU_IcssPdInfo</a> *pi)</td></tr>
<tr class="memdesc:a866dc644841cd14596406a0216d253c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closed the EMAC peripheral indicated by the supplied instance handle. When called, the EMAC device will shutdown both send and receive operations, and free all pending transmit and receive packets.  <a href="#a866dc644841cd14596406a0216d253c3">More...</a><br /></td></tr>
<tr class="separator:a866dc644841cd14596406a0216d253c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57144366e1c07821f767ec478ba57048"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nimu__icss_switch_emac_8c.html#a57144366e1c07821f767ec478ba57048">NIMU_ICSS_getStatistics</a> (<a class="el" href="nimu__icss_eth_8h.html#a9ef1984a01e51df3e3d4507e989ce2c7">NIMU_IcssPdInfo</a> *pi, <a class="el" href="struct_n_i_m_u___icss_statistics__s.html">NIMU_IcssStatistics</a> *pStatistics, uint8_t portNo)</td></tr>
<tr class="memdesc:a57144366e1c07821f767ec478ba57048"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to get the current device statistics. The statistics structure contains a collection of event counts for various packet sent and receive properties. Reading the statistics also clears the current statistic counters, so the values read represent a delta from the last call.  <a href="#a57144366e1c07821f767ec478ba57048">More...</a><br /></td></tr>
<tr class="separator:a57144366e1c07821f767ec478ba57048"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6779ea3c5360a1aedf77e7c17460295d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6779ea3c5360a1aedf77e7c17460295d"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nimu__icss_switch_emac_8c.html#a6779ea3c5360a1aedf77e7c17460295d">NIMU_ICSS_clearStatistics</a> (<a class="el" href="nimu__icss_eth_8h.html#a9ef1984a01e51df3e3d4507e989ce2c7">NIMU_IcssPdInfo</a> *pi, uint8_t portNo)</td></tr>
<tr class="memdesc:a6779ea3c5360a1aedf77e7c17460295d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to clear the current device statistics for a particular port. <br /></td></tr>
<tr class="separator:a6779ea3c5360a1aedf77e7c17460295d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a670dd148d39459a1ca400769ed61debb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a670dd148d39459a1ca400769ed61debb"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nimu__icss_switch_emac_8c.html#a670dd148d39459a1ca400769ed61debb">NIMU_ICSS_setConfig</a> (<a class="el" href="nimu__icss_eth_8h.html#a9ef1984a01e51df3e3d4507e989ce2c7">NIMU_IcssPdInfo</a> *pi, void *pBuf, uint32_t size)</td></tr>
<tr class="memdesc:a670dd148d39459a1ca400769ed61debb"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is called to perform various get/set operations on the EMAC ALE table, statistics counters etc. <br /></td></tr>
<tr class="separator:a670dd148d39459a1ca400769ed61debb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a749b5e8c004d200dc166f678c321ae44"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a749b5e8c004d200dc166f678c321ae44"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nimu__icss_switch_emac_8c.html#a749b5e8c004d200dc166f678c321ae44">NIMU_ICSS_sendPacket</a> (Handle hEMAC, <a class="el" href="nimu__icss_switch_emac_8h.html#a84525504342c268de0301abce94f5e8a">NIMU_IcssEmacPkt</a> *pPkt)</td></tr>
<tr class="memdesc:a749b5e8c004d200dc166f678c321ae44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a Ethernet data packet out the EMAC device. On a non-error return, the EMAC device takes ownership of the packet. The packet is returned to the application's free pool once it has been transmitted. <br /></td></tr>
<tr class="separator:a749b5e8c004d200dc166f678c321ae44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5f095a79ac0ba061af10987ed2d9f1b"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nimu__icss_switch_emac_8c.html#ad5f095a79ac0ba061af10987ed2d9f1b">NIMU_ICSS_rxServiceCheck</a> (ICSS_EmacHandle hEMAC, int32_t prioQueue)</td></tr>
<tr class="memdesc:ad5f095a79ac0ba061af10987ed2d9f1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function should be called every time there is an EMAC device Rx interrupt to process the packet.  <a href="#ad5f095a79ac0ba061af10987ed2d9f1b">More...</a><br /></td></tr>
<tr class="separator:ad5f095a79ac0ba061af10987ed2d9f1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains helper functions used to implement NDK NIMU transport driver interface for ICSS. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a866dc644841cd14596406a0216d253c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t NIMU_ICSS_closePeripheral </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="nimu__icss_eth_8h.html#a9ef1984a01e51df3e3d4507e989ce2c7">NIMU_IcssPdInfo</a> *&#160;</td>
          <td class="paramname"><em>pi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closed the EMAC peripheral indicated by the supplied instance handle. When called, the EMAC device will shutdown both send and receive operations, and free all pending transmit and receive packets. </p>
<p>The function returns zero on success, or an error code on failure. Possible error code include: NIMU_ICSS_INVALID_PARAM - A calling parameter is invalid </p>

</div>
</div>
<a class="anchor" id="a57144366e1c07821f767ec478ba57048"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t NIMU_ICSS_getStatistics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="nimu__icss_eth_8h.html#a9ef1984a01e51df3e3d4507e989ce2c7">NIMU_IcssPdInfo</a> *&#160;</td>
          <td class="paramname"><em>pi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_n_i_m_u___icss_statistics__s.html">NIMU_IcssStatistics</a> *&#160;</td>
          <td class="paramname"><em>pStatistics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>portNo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called to get the current device statistics. The statistics structure contains a collection of event counts for various packet sent and receive properties. Reading the statistics also clears the current statistic counters, so the values read represent a delta from the last call. </p>
<p>The statistics information is copied into the structure pointed to by the pStatistics argument. The function returns zero on success, or an error code on failure. Possible error code include: NIMU_ICSS_INVALID_PARAM - A calling parameter is invalid </p>

</div>
</div>
<a class="anchor" id="a844e765225701ffbdb121af92a5efdf0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NIMU_ICSS_openPeripheral </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="nimu__icss_eth_8h.html#a9ef1984a01e51df3e3d4507e989ce2c7">NIMU_IcssPdInfo</a> *&#160;</td>
          <td class="paramname"><em>pi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens the EMAC peripheral at the given physical index and initializes it to an embryonic state. </p>
<p>The calling application must supply a operating configuration that includes a callback function table. Data from this config structure is copied into the device's internal instance structure so the structure may be discarded after <a class="el" href="nimu__icss_switch_emac_8h.html#a844e765225701ffbdb121af92a5efdf0" title="Opens the EMAC peripheral at the given physical index and initializes it to an embryonic state...">NIMU_ICSS_openPeripheral()</a> returns. In order to change an item in the configuration, the EMAC device must be closed and then re-opened with the new configuration. </p><pre class="fragment">The application layer may pass in an hApplication callback handle,
</pre><p> that will be supplied by the EMAC device when making calls to the application callback functions.</p>
<p>An EMAC device handle is written to phEMAC. This handle must be saved by the caller and then passed to other EMAC device functions.</p>
<p>The default receive filter prevents normal packets from being received until the receive filter is specified by calling EMAC_receiveFilter().</p>
<p>A device reset is achieved by calling <a class="el" href="nimu__icss_switch_emac_8h.html#a866dc644841cd14596406a0216d253c3" title="Closed the EMAC peripheral indicated by the supplied instance handle. When called, the EMAC device will shutdown both send and receive operations, and free all pending transmit and receive packets. ">NIMU_ICSS_closePeripheral()</a> followed by <a class="el" href="nimu__icss_switch_emac_8h.html#a844e765225701ffbdb121af92a5efdf0" title="Opens the EMAC peripheral at the given physical index and initializes it to an embryonic state...">NIMU_ICSS_openPeripheral()</a>.</p>
<p>The function returns zero on success, or an error code on failure.</p>
<p>Possible error codes include: SWITCH_ERR_DEV_ALREADY_OPEN - The device is already open NIMU_ICSS_INVALID_PARAM - A calling parameter is invalid </p>

</div>
</div>
<a class="anchor" id="ad5f095a79ac0ba061af10987ed2d9f1b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t NIMU_ICSS_rxServiceCheck </td>
          <td>(</td>
          <td class="paramtype">ICSS_EmacHandle&#160;</td>
          <td class="paramname"><em>hEMAC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>prioQueue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function should be called every time there is an EMAC device Rx interrupt to process the packet. </p>
<p>Note that the application has the responsibility for mapping the physical device index to the correct EMAC_serviceCheck() function. If more than one EMAC device is on the same interrupt, the function must be called for each device. </p>

</div>
</div>
</div><!-- contents -->
<hr size="1"><small>
Copyright  2020, Texas Instruments Incorporated</small>
</body>
</html>
